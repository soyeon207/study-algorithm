## 11660 구간 합 구하기 5
### 문제 
N×N개의 수가 N×N 크기의 표에 채워져 있다. (x1, y1)부터 (x2, y2)까지 합을 구하는 프로그램을 작성하시오. (x, y)는 x행 y열을 의미한다.

예를 들어, N = 4이고, 표가 아래와 같이 채워져 있는 경우를 살펴보자.

|||||
|---|---|---|---|
|1|2|3|4|
|2|3|4|5|
|3|4|5|6|
|4|5|6|7|

여기서 (2, 2)부터 (3, 4)까지 합을 구하면 3+4+5+4+5+6 = 27이고, (4, 4)부터 (4, 4)까지 합을 구하면 7이다.

표에 채워져 있는 수와 합을 구하는 연산이 주어졌을 때, 이를 처리하는 프로그램을 작성하시오.

### 입력
첫째 줄에 표의 크기 N과 합을 구해야 하는 횟수 M이 주어진다. (1 ≤ N ≤ 1024, 1 ≤ M ≤ 100,000) 둘째 줄부터 N개의 줄에는 표에 채워져 있는 수가 1행부터 차례대로 주어진다. 다음 M개의 줄에는 네 개의 정수 x1, y1, x2, y2 가 주어지며, (x1, y1)부터 (x2, y2)의 합을 구해 출력해야 한다. 표에 채워져 있는 수는 1,000보다 작거나 같은 자연수이다. (x1 ≤ x2, y1 ≤ y2)

### 출력 
총 M줄에 걸쳐 (x1, y1)부터 (x2, y2)까지 합을 구해 출력한다.

### EX
예제 입력 1
```
4 3
1 2 3 4
2 3 4 5
3 4 5 6
4 5 6 7
2 2 3 4
3 4 3 4
1 1 4 4
```

예제 출력 1
```
27
6
64
```

## 풀이 
### 01단계 문제 분석하기 
먼저 질의의 개수가 100,000 이므로 이 문제 역시 질의마다 합을 구하면 안되고, 구간 합 배열을 이용해야 한다. 구간 합 배열이 1차원에서 2차원으로 확장된 것으로 생각하여 구간 합 배열을 어떻게 구성할지 고민하는 것이 이 문제의 핵심이다. 2차원 구간 합 배열은 다음과 같이 정의할 수 있다. 

**2차원 구간 합 배열D[X][Y] 정의**
```
D[X][Y] = 원본 배열의 (0,0)부터 (X,Y)까지의 사각형 영역 안에 있는 수의 합
```

### 02단계 손으로 풀어 보기 
1. 2차원 구간 합 배열의 1행, 1열부터 구한다. 구간 합 배열 1행, 1열은 다음과 같이 구한다. 

```
D[i][1] = D[i-1][1] + A[i][1]
D[1][j] = D[1][j-1] + A[1][j]
```

2. 이를 통해 나머지 2차원 구간 합 배열을 채운다. 
D[i][j]의 값을 채우는 구간 합 공식
```
D[i][j] = D[i][j-1] + D[i-1][j] - D[i-1][j-1] + A[i][j]
```

3. 구간 합 배열을 이용하기 전에 질의에 대한 답을 도출하기 위한 과정을 원본 배열과 함께 살펴보자. 다음은 원본 배열에 구간 합을 표시하여 질의에 대한 답을 도출하는 과정을 보여준다. 

예를 들어 질의가 2 2 3 4 라면 (3,4) 구간 합에서 (1,4) 구간합, (3,1) 구간 합을 뺀 다음 중복하여 뺀 (1,1) 구간 합을 더하면 된다. 

**질의 X<sub>1</sub>, Y<sub>1</sub>, X<sub>2</sub>, Y<sub>2</sub>에 대한 답을 구간 합으로 구하는 방법**
```
D[X<sub>2</sub>][Y<sub>2</sub>] - D[X<sub>1</sub>-1][Y<sub>2</sub>] - D[X<sub>2</sub>][Y<sub>1</sub>-1] + D[X<sub>1</sub>-1][Y<sub>1</sub>-1]
```

### 03단계 슈도코드 작성하기
```
N(배열 크기) M(질의 수) 저장하기
for(N만큼 반복하기) {
    for(N만큼 반복하기) {
        원본 배열 젖아하기
    }
}

for(N만큼 반복하기) {
    for(N만큼 반복하기) {
        합 배열 저장하기
        D[i][j] = D[i][j-1] + D[i-1][j] - D[i-1][j-1] + A[i][j];
    }
}

for(M만큼 반복하기) {
    질의 계산 및 출력하기
    결과 = D[x2][y2] - D[x1-1][y2] - D[x2][y1-1] + D[x1-1][y1-1];
})
```
